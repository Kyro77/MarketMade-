<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adelaide Central Market</title>
    <link rel="stylesheet" href="Index.css">
</head>
<body>

    <header>
        <img src="/Screenshot 2025-08-14 105531.png" alt="Adelaide Central Market Logo">
    </header>

    <div class="filters-container">
        <!-- Search -->
        <input type="text" id="search" placeholder="Search products...">

        <!-- Stall Filter -->
        <select id="stallFilter">
            <option value="">All Stalls</option>
        </select>

        <!-- Categories -->
        <div class="categories">
            <button class="filterBtn" data-category="fruitveg">Fruit & Veg</button>
            <button class="filterBtn" data-category="meatseafood">Meat & Seafood</button>
            <button class="filterBtn" data-category="bakery">Bakery</button>
            <button class="filterBtn" data-category="dairy">Dairy</button>
        </div>
    </div>

    <!-- Container for product tiles -->
    <section class="productContainer"></section>

    <!-- Load More button -->
    <button id="loadMoreBtn">Load More</button>

    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const container = document.querySelector(".productContainer");
        const searchInput = document.getElementById("search");
        const stallFilter = document.getElementById("stallFilter");
        const categoryButtons = document.querySelectorAll(".filterBtn");
        const loadMoreBtn = document.getElementById("loadMoreBtn");

        let allProducts = [];
        let filteredProducts = [];
        let renderedCount = 0;
        const pageSize = 30;
        let activeCategory = "";

        // Fetch JSON
        fetch("products.json")
            .then(res => res.json())
            .then(products => {
                allProducts = products;
                filteredProducts = [...allProducts];

                populateStallDropdown();
                renderTiles();
            });

        // Populate stall dropdown
        function populateStallDropdown() {
            const uniqueStalls = [...new Set(allProducts.map(p => p["Stall name"]))].sort();
            uniqueStalls.forEach(stall => {
                const option = document.createElement("option");
                option.value = stall.toLowerCase();
                option.textContent = stall;
                stallFilter.appendChild(option);
            });
        }

        // Render tiles
        function renderTiles(reset = true) {
            if (reset) {
                container.innerHTML = "";
                renderedCount = 0;
            }

            const toRender = filteredProducts.slice(renderedCount, renderedCount + pageSize);
            toRender.forEach(product => {
                const tile = document.createElement("div");
                tile.classList.add("producttile");
                tile.dataset.stall = product["Stall name"].toLowerCase();
                tile.dataset.name = product.Item.toLowerCase();
                tile.dataset.category = (product.Category || "").toLowerCase();

                tile.innerHTML = `
                    <img src="${product["img link"]}" alt="${product.Item}">
                    <div class="Textinfo">
                        <h2>${product.Item}</h2>
                        <h3>${product["Stall name"]}</h3>
                        <p><strong>Stall:</strong> <span class="stall-number">${product["Stall Number"] || ""}</span></p>
                    </div>
                `;

                container.appendChild(tile);
            });

            renderedCount += toRender.length;
            loadMoreBtn.style.display = (renderedCount >= filteredProducts.length) ? "none" : "block";
        }

        // Apply filters
        function applyFilters() {
            const searchTerm = searchInput.value.toLowerCase();
            const selectedStall = stallFilter.value;

            filteredProducts = allProducts.filter(p => {
                const matchesSearch = p.Item.toLowerCase().includes(searchTerm);
                const matchesStall = !selectedStall || p["Stall name"].toLowerCase() === selectedStall;
                const matchesCategory = !activeCategory || (p.Category || "").toLowerCase() === activeCategory;
                return matchesSearch && matchesStall && matchesCategory;
            });

            renderTiles(true);
        }

        // Event listeners
        searchInput.addEventListener("input", applyFilters);
        stallFilter.addEventListener("change", applyFilters);

        categoryButtons.forEach(btn => {
            btn.addEventListener("click", () => {
                activeCategory = btn.dataset.category;
                applyFilters();
            });
        });

        loadMoreBtn.addEventListener("click", () => renderTiles(false));
    });
    </script>

</body>
</html>






